/**
 * 
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return TransactionListenerManager;
    }
});
const _metaApiclient = /*#__PURE__*/ _interop_require_default(require("../../metaApi.client"));
const _randomstring = /*#__PURE__*/ _interop_require_default(require("randomstring"));
const _logger = /*#__PURE__*/ _interop_require_default(require("../../../logger"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
let TransactionListenerManager = class TransactionListenerManager extends _metaApiclient.default {
    /**
   * Returns the dictionary of strategy transaction listeners
   * @returns {Object} dictionary of strategy transaction listeners
   */ get strategyTransactionListeners() {
        return this._strategyTransactionListeners;
    }
    /**
   * Returns the dictionary of subscriber transaction listeners
   * @returns {Object} dictionary of subscriber transaction listeners
   */ get subscriberTransactionListeners() {
        return this._subscriberTransactionListeners;
    }
    /**
   * Adds a strategy transaction listener
   * @param {UserTransactionListener} listener user transaction listener
   * @param {String} strategyId strategy id
   * @param {Date} [startTime] transaction search start time
   * @returns {String} strategy transaction listener id
   */ addStrategyTransactionListener(listener, strategyId, startTime) {
        const listenerId = _randomstring.default.generate(10);
        this._strategyTransactionListeners[listenerId] = listener;
        this._startStrategyTransactionStreamJob(listenerId, listener, strategyId, startTime);
        return listenerId;
    }
    /**
   * Adds a subscriber transaction listener
   * @param {UserTransactionListener} listener user transaction listener
   * @param {String} subscriberId subscriber id
   * @param {Date} [startTime] transaction search start time
   * @returns {String} subscriber transaction listener id
   */ addSubscriberTransactionListener(listener, subscriberId, startTime) {
        const listenerId = _randomstring.default.generate(10);
        this._subscriberTransactionListeners[listenerId] = listener;
        this._startSubscriberTransactionStreamJob(listenerId, listener, subscriberId, startTime);
        return listenerId;
    }
    /**
   * Removes strategy transaction listener by id
   * @param {String} listenerId listener id 
   */ removeStrategyTransactionListener(listenerId) {
        delete this._strategyTransactionListeners[listenerId];
    }
    /**
   * Removes subscriber transaction listener by id
   * @param {String} listenerId listener id 
   */ removeSubscriberTransactionListener(listenerId) {
        delete this._subscriberTransactionListeners[listenerId];
    }
    async _startStrategyTransactionStreamJob(listenerId, listener, strategyId, startTime) {
        let throttleTime = this._errorThrottleTime;
        while(this._strategyTransactionListeners[listenerId]){
            const opts = {
                url: `/users/current/strategies/${strategyId}/transactions/stream`,
                method: "GET",
                params: {
                    startTime,
                    limit: 1000
                },
                headers: {
                    "auth-token": this._token
                },
                json: true
            };
            try {
                const packets = await this._domainClient.requestCopyFactory(opts, true);
                await listener.onTransaction(packets);
                throttleTime = this._errorThrottleTime;
                if (this._strategyTransactionListeners[listenerId] && packets.length) {
                    startTime = new Date(new Date(packets[0].time).getTime() + 1);
                }
            } catch (err) {
                await listener.onError(err);
                if (err.name === "NotFoundError") {
                    this._logger.error(`Strategy ${strategyId} not found, removing listener ${listenerId}`);
                    delete this._strategyTransactionListeners[listenerId];
                } else {
                    this._logger.error(`Failed to retrieve transactions stream for strategy ${strategyId}, ` + `listener ${listenerId}, retrying in ${Math.floor(throttleTime / 1000)} seconds`, err);
                    await new Promise((res)=>setTimeout(res, throttleTime));
                    throttleTime = Math.min(throttleTime * 2, 30000);
                }
            }
        }
    }
    async _startSubscriberTransactionStreamJob(listenerId, listener, subscriberId, startTime) {
        let throttleTime = this._errorThrottleTime;
        while(this._subscriberTransactionListeners[listenerId]){
            const opts = {
                url: `/users/current/subscribers/${subscriberId}/transactions/stream`,
                method: "GET",
                params: {
                    startTime,
                    limit: 1000
                },
                headers: {
                    "auth-token": this._token
                },
                json: true
            };
            try {
                const packets = await this._domainClient.requestCopyFactory(opts, true);
                await listener.onTransaction(packets);
                throttleTime = this._errorThrottleTime;
                if (this._subscriberTransactionListeners[listenerId] && packets.length) {
                    startTime = new Date(new Date(packets[0].time).getTime() + 1);
                }
            } catch (err) {
                await listener.onError(err);
                if (err.name === "NotFoundError") {
                    this._logger.error(`Subscriber ${subscriberId} not found, removing listener ${listenerId}`);
                    delete this._subscriberTransactionListeners[listenerId];
                } else {
                    this._logger.error(`Failed to retrieve transactions stream for subscriber ${subscriberId}, ` + `listener ${listenerId}, retrying in ${Math.floor(throttleTime / 1000)} seconds`, err);
                    await new Promise((res)=>setTimeout(res, throttleTime));
                    throttleTime = Math.min(throttleTime * 2, 30000);
                }
            }
        }
    }
    /**
   * Constructs transaction event listener manager instance
   * @param {DomainClient} domainClient domain client
   */ constructor(domainClient){
        super(domainClient);
        this._domainClient = domainClient;
        this._strategyTransactionListeners = {};
        this._subscriberTransactionListeners = {};
        this._errorThrottleTime = 1000;
        this._logger = _logger.default.getLogger("TransactionListenerManager");
    }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjxhbm9uPiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFxuICovJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgTWV0YUFwaUNsaWVudCBmcm9tICcuLi8uLi9tZXRhQXBpLmNsaWVudCc7XG5pbXBvcnQgcmFuZG9tc3RyaW5nIGZyb20gJ3JhbmRvbXN0cmluZyc7XG5pbXBvcnQgTG9nZ2VyTWFuYWdlciBmcm9tICcuLi8uLi8uLi9sb2dnZXInO1xuXG4vKipcbiAqIFRyYW5zYWN0aW9uIGV2ZW50IGxpc3RlbmVyIG1hbmFnZXJcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVHJhbnNhY3Rpb25MaXN0ZW5lck1hbmFnZXIgZXh0ZW5kcyBNZXRhQXBpQ2xpZW50IHtcblxuICAvKipcbiAgICogQ29uc3RydWN0cyB0cmFuc2FjdGlvbiBldmVudCBsaXN0ZW5lciBtYW5hZ2VyIGluc3RhbmNlXG4gICAqIEBwYXJhbSB7RG9tYWluQ2xpZW50fSBkb21haW5DbGllbnQgZG9tYWluIGNsaWVudFxuICAgKi9cbiAgY29uc3RydWN0b3IoZG9tYWluQ2xpZW50KSB7XG4gICAgc3VwZXIoZG9tYWluQ2xpZW50KTtcbiAgICB0aGlzLl9kb21haW5DbGllbnQgPSBkb21haW5DbGllbnQ7XG4gICAgdGhpcy5fc3RyYXRlZ3lUcmFuc2FjdGlvbkxpc3RlbmVycyA9IHt9O1xuICAgIHRoaXMuX3N1YnNjcmliZXJUcmFuc2FjdGlvbkxpc3RlbmVycyA9IHt9O1xuICAgIHRoaXMuX2Vycm9yVGhyb3R0bGVUaW1lID0gMTAwMDtcbiAgICB0aGlzLl9sb2dnZXIgPSBMb2dnZXJNYW5hZ2VyLmdldExvZ2dlcignVHJhbnNhY3Rpb25MaXN0ZW5lck1hbmFnZXInKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBkaWN0aW9uYXJ5IG9mIHN0cmF0ZWd5IHRyYW5zYWN0aW9uIGxpc3RlbmVyc1xuICAgKiBAcmV0dXJucyB7T2JqZWN0fSBkaWN0aW9uYXJ5IG9mIHN0cmF0ZWd5IHRyYW5zYWN0aW9uIGxpc3RlbmVyc1xuICAgKi9cbiAgZ2V0IHN0cmF0ZWd5VHJhbnNhY3Rpb25MaXN0ZW5lcnMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3N0cmF0ZWd5VHJhbnNhY3Rpb25MaXN0ZW5lcnM7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgZGljdGlvbmFyeSBvZiBzdWJzY3JpYmVyIHRyYW5zYWN0aW9uIGxpc3RlbmVyc1xuICAgKiBAcmV0dXJucyB7T2JqZWN0fSBkaWN0aW9uYXJ5IG9mIHN1YnNjcmliZXIgdHJhbnNhY3Rpb24gbGlzdGVuZXJzXG4gICAqL1xuICBnZXQgc3Vic2NyaWJlclRyYW5zYWN0aW9uTGlzdGVuZXJzKCkge1xuICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmVyVHJhbnNhY3Rpb25MaXN0ZW5lcnM7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBhIHN0cmF0ZWd5IHRyYW5zYWN0aW9uIGxpc3RlbmVyXG4gICAqIEBwYXJhbSB7VXNlclRyYW5zYWN0aW9uTGlzdGVuZXJ9IGxpc3RlbmVyIHVzZXIgdHJhbnNhY3Rpb24gbGlzdGVuZXJcbiAgICogQHBhcmFtIHtTdHJpbmd9IHN0cmF0ZWd5SWQgc3RyYXRlZ3kgaWRcbiAgICogQHBhcmFtIHtEYXRlfSBbc3RhcnRUaW1lXSB0cmFuc2FjdGlvbiBzZWFyY2ggc3RhcnQgdGltZVxuICAgKiBAcmV0dXJucyB7U3RyaW5nfSBzdHJhdGVneSB0cmFuc2FjdGlvbiBsaXN0ZW5lciBpZFxuICAgKi9cbiAgYWRkU3RyYXRlZ3lUcmFuc2FjdGlvbkxpc3RlbmVyKGxpc3RlbmVyLCBzdHJhdGVneUlkLCBzdGFydFRpbWUpIHtcbiAgICBjb25zdCBsaXN0ZW5lcklkID0gcmFuZG9tc3RyaW5nLmdlbmVyYXRlKDEwKTtcbiAgICB0aGlzLl9zdHJhdGVneVRyYW5zYWN0aW9uTGlzdGVuZXJzW2xpc3RlbmVySWRdID0gbGlzdGVuZXI7XG4gICAgdGhpcy5fc3RhcnRTdHJhdGVneVRyYW5zYWN0aW9uU3RyZWFtSm9iKGxpc3RlbmVySWQsIGxpc3RlbmVyLCBzdHJhdGVneUlkLCBzdGFydFRpbWUpO1xuICAgIHJldHVybiBsaXN0ZW5lcklkO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYSBzdWJzY3JpYmVyIHRyYW5zYWN0aW9uIGxpc3RlbmVyXG4gICAqIEBwYXJhbSB7VXNlclRyYW5zYWN0aW9uTGlzdGVuZXJ9IGxpc3RlbmVyIHVzZXIgdHJhbnNhY3Rpb24gbGlzdGVuZXJcbiAgICogQHBhcmFtIHtTdHJpbmd9IHN1YnNjcmliZXJJZCBzdWJzY3JpYmVyIGlkXG4gICAqIEBwYXJhbSB7RGF0ZX0gW3N0YXJ0VGltZV0gdHJhbnNhY3Rpb24gc2VhcmNoIHN0YXJ0IHRpbWVcbiAgICogQHJldHVybnMge1N0cmluZ30gc3Vic2NyaWJlciB0cmFuc2FjdGlvbiBsaXN0ZW5lciBpZFxuICAgKi9cbiAgYWRkU3Vic2NyaWJlclRyYW5zYWN0aW9uTGlzdGVuZXIobGlzdGVuZXIsIHN1YnNjcmliZXJJZCwgc3RhcnRUaW1lKSB7XG4gICAgY29uc3QgbGlzdGVuZXJJZCA9IHJhbmRvbXN0cmluZy5nZW5lcmF0ZSgxMCk7XG4gICAgdGhpcy5fc3Vic2NyaWJlclRyYW5zYWN0aW9uTGlzdGVuZXJzW2xpc3RlbmVySWRdID0gbGlzdGVuZXI7XG4gICAgdGhpcy5fc3RhcnRTdWJzY3JpYmVyVHJhbnNhY3Rpb25TdHJlYW1Kb2IobGlzdGVuZXJJZCwgbGlzdGVuZXIsIHN1YnNjcmliZXJJZCwgc3RhcnRUaW1lKTtcbiAgICByZXR1cm4gbGlzdGVuZXJJZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmVzIHN0cmF0ZWd5IHRyYW5zYWN0aW9uIGxpc3RlbmVyIGJ5IGlkXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBsaXN0ZW5lcklkIGxpc3RlbmVyIGlkIFxuICAgKi9cbiAgcmVtb3ZlU3RyYXRlZ3lUcmFuc2FjdGlvbkxpc3RlbmVyKGxpc3RlbmVySWQpIHtcbiAgICBkZWxldGUgdGhpcy5fc3RyYXRlZ3lUcmFuc2FjdGlvbkxpc3RlbmVyc1tsaXN0ZW5lcklkXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmVzIHN1YnNjcmliZXIgdHJhbnNhY3Rpb24gbGlzdGVuZXIgYnkgaWRcbiAgICogQHBhcmFtIHtTdHJpbmd9IGxpc3RlbmVySWQgbGlzdGVuZXIgaWQgXG4gICAqL1xuICByZW1vdmVTdWJzY3JpYmVyVHJhbnNhY3Rpb25MaXN0ZW5lcihsaXN0ZW5lcklkKSB7XG4gICAgZGVsZXRlIHRoaXMuX3N1YnNjcmliZXJUcmFuc2FjdGlvbkxpc3RlbmVyc1tsaXN0ZW5lcklkXTtcbiAgfVxuXG4gIGFzeW5jIF9zdGFydFN0cmF0ZWd5VHJhbnNhY3Rpb25TdHJlYW1Kb2IobGlzdGVuZXJJZCwgbGlzdGVuZXIsIHN0cmF0ZWd5SWQsIHN0YXJ0VGltZSkge1xuICAgIGxldCB0aHJvdHRsZVRpbWUgPSB0aGlzLl9lcnJvclRocm90dGxlVGltZTtcblxuICAgIHdoaWxlKHRoaXMuX3N0cmF0ZWd5VHJhbnNhY3Rpb25MaXN0ZW5lcnNbbGlzdGVuZXJJZF0pIHtcbiAgICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICAgIHVybDogYC91c2Vycy9jdXJyZW50L3N0cmF0ZWdpZXMvJHtzdHJhdGVneUlkfS90cmFuc2FjdGlvbnMvc3RyZWFtYCxcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgc3RhcnRUaW1lLFxuICAgICAgICAgIGxpbWl0OiAxMDAwXG4gICAgICAgIH0sXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnYXV0aC10b2tlbic6IHRoaXMuX3Rva2VuXG4gICAgICAgIH0sXG4gICAgICAgIGpzb246IHRydWVcbiAgICAgIH07XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBwYWNrZXRzID0gYXdhaXQgdGhpcy5fZG9tYWluQ2xpZW50LnJlcXVlc3RDb3B5RmFjdG9yeShvcHRzLCB0cnVlKTtcbiAgICAgICAgYXdhaXQgbGlzdGVuZXIub25UcmFuc2FjdGlvbihwYWNrZXRzKTtcbiAgICAgICAgdGhyb3R0bGVUaW1lID0gdGhpcy5fZXJyb3JUaHJvdHRsZVRpbWU7XG4gICAgICAgIGlmKHRoaXMuX3N0cmF0ZWd5VHJhbnNhY3Rpb25MaXN0ZW5lcnNbbGlzdGVuZXJJZF0gJiYgcGFja2V0cy5sZW5ndGgpIHtcbiAgICAgICAgICBzdGFydFRpbWUgPSBuZXcgRGF0ZShuZXcgRGF0ZShwYWNrZXRzWzBdLnRpbWUpLmdldFRpbWUoKSArIDEpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgYXdhaXQgbGlzdGVuZXIub25FcnJvcihlcnIpO1xuICAgICAgICBpZiAoZXJyLm5hbWUgPT09ICdOb3RGb3VuZEVycm9yJykge1xuICAgICAgICAgIHRoaXMuX2xvZ2dlci5lcnJvcihgU3RyYXRlZ3kgJHtzdHJhdGVneUlkfSBub3QgZm91bmQsIHJlbW92aW5nIGxpc3RlbmVyICR7bGlzdGVuZXJJZH1gKTtcbiAgICAgICAgICBkZWxldGUgdGhpcy5fc3RyYXRlZ3lUcmFuc2FjdGlvbkxpc3RlbmVyc1tsaXN0ZW5lcklkXTsgXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5fbG9nZ2VyLmVycm9yKGBGYWlsZWQgdG8gcmV0cmlldmUgdHJhbnNhY3Rpb25zIHN0cmVhbSBmb3Igc3RyYXRlZ3kgJHtzdHJhdGVneUlkfSwgYCArXG4gICAgICAgICAgICBgbGlzdGVuZXIgJHtsaXN0ZW5lcklkfSwgcmV0cnlpbmcgaW4gJHtNYXRoLmZsb29yKHRocm90dGxlVGltZS8xMDAwKX0gc2Vjb25kc2AsIGVycik7XG4gICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzID0+IHNldFRpbWVvdXQocmVzLCB0aHJvdHRsZVRpbWUpKTtcbiAgICAgICAgICB0aHJvdHRsZVRpbWUgPSBNYXRoLm1pbih0aHJvdHRsZVRpbWUgKiAyLCAzMDAwMCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhc3luYyBfc3RhcnRTdWJzY3JpYmVyVHJhbnNhY3Rpb25TdHJlYW1Kb2IobGlzdGVuZXJJZCwgbGlzdGVuZXIsIHN1YnNjcmliZXJJZCwgc3RhcnRUaW1lKSB7XG4gICAgbGV0IHRocm90dGxlVGltZSA9IHRoaXMuX2Vycm9yVGhyb3R0bGVUaW1lO1xuXG4gICAgd2hpbGUodGhpcy5fc3Vic2NyaWJlclRyYW5zYWN0aW9uTGlzdGVuZXJzW2xpc3RlbmVySWRdKSB7XG4gICAgICBjb25zdCBvcHRzID0ge1xuICAgICAgICB1cmw6IGAvdXNlcnMvY3VycmVudC9zdWJzY3JpYmVycy8ke3N1YnNjcmliZXJJZH0vdHJhbnNhY3Rpb25zL3N0cmVhbWAsXG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIHN0YXJ0VGltZSxcbiAgICAgICAgICBsaW1pdDogMTAwMFxuICAgICAgICB9LFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgICB9LFxuICAgICAgICBqc29uOiB0cnVlXG4gICAgICB9O1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcGFja2V0cyA9IGF3YWl0IHRoaXMuX2RvbWFpbkNsaWVudC5yZXF1ZXN0Q29weUZhY3Rvcnkob3B0cywgdHJ1ZSk7XG4gICAgICAgIGF3YWl0IGxpc3RlbmVyLm9uVHJhbnNhY3Rpb24ocGFja2V0cyk7XG4gICAgICAgIHRocm90dGxlVGltZSA9IHRoaXMuX2Vycm9yVGhyb3R0bGVUaW1lO1xuICAgICAgICBpZih0aGlzLl9zdWJzY3JpYmVyVHJhbnNhY3Rpb25MaXN0ZW5lcnNbbGlzdGVuZXJJZF0gJiYgcGFja2V0cy5sZW5ndGgpIHtcbiAgICAgICAgICBzdGFydFRpbWUgPSBuZXcgRGF0ZShuZXcgRGF0ZShwYWNrZXRzWzBdLnRpbWUpLmdldFRpbWUoKSArIDEpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgYXdhaXQgbGlzdGVuZXIub25FcnJvcihlcnIpO1xuICAgICAgICBpZiAoZXJyLm5hbWUgPT09ICdOb3RGb3VuZEVycm9yJykge1xuICAgICAgICAgIHRoaXMuX2xvZ2dlci5lcnJvcihgU3Vic2NyaWJlciAke3N1YnNjcmliZXJJZH0gbm90IGZvdW5kLCByZW1vdmluZyBsaXN0ZW5lciAke2xpc3RlbmVySWR9YCk7XG4gICAgICAgICAgZGVsZXRlIHRoaXMuX3N1YnNjcmliZXJUcmFuc2FjdGlvbkxpc3RlbmVyc1tsaXN0ZW5lcklkXTsgXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5fbG9nZ2VyLmVycm9yKGBGYWlsZWQgdG8gcmV0cmlldmUgdHJhbnNhY3Rpb25zIHN0cmVhbSBmb3Igc3Vic2NyaWJlciAke3N1YnNjcmliZXJJZH0sIGAgK1xuICAgICAgICAgICAgYGxpc3RlbmVyICR7bGlzdGVuZXJJZH0sIHJldHJ5aW5nIGluICR7TWF0aC5mbG9vcih0aHJvdHRsZVRpbWUvMTAwMCl9IHNlY29uZHNgLCBlcnIpO1xuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlcyA9PiBzZXRUaW1lb3V0KHJlcywgdGhyb3R0bGVUaW1lKSk7XG4gICAgICAgICAgdGhyb3R0bGVUaW1lID0gTWF0aC5taW4odGhyb3R0bGVUaW1lICogMiwgMzAwMDApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbn1cbiJdLCJuYW1lcyI6WyJUcmFuc2FjdGlvbkxpc3RlbmVyTWFuYWdlciIsIk1ldGFBcGlDbGllbnQiLCJzdHJhdGVneVRyYW5zYWN0aW9uTGlzdGVuZXJzIiwiX3N0cmF0ZWd5VHJhbnNhY3Rpb25MaXN0ZW5lcnMiLCJzdWJzY3JpYmVyVHJhbnNhY3Rpb25MaXN0ZW5lcnMiLCJfc3Vic2NyaWJlclRyYW5zYWN0aW9uTGlzdGVuZXJzIiwiYWRkU3RyYXRlZ3lUcmFuc2FjdGlvbkxpc3RlbmVyIiwibGlzdGVuZXIiLCJzdHJhdGVneUlkIiwic3RhcnRUaW1lIiwibGlzdGVuZXJJZCIsInJhbmRvbXN0cmluZyIsImdlbmVyYXRlIiwiX3N0YXJ0U3RyYXRlZ3lUcmFuc2FjdGlvblN0cmVhbUpvYiIsImFkZFN1YnNjcmliZXJUcmFuc2FjdGlvbkxpc3RlbmVyIiwic3Vic2NyaWJlcklkIiwiX3N0YXJ0U3Vic2NyaWJlclRyYW5zYWN0aW9uU3RyZWFtSm9iIiwicmVtb3ZlU3RyYXRlZ3lUcmFuc2FjdGlvbkxpc3RlbmVyIiwicmVtb3ZlU3Vic2NyaWJlclRyYW5zYWN0aW9uTGlzdGVuZXIiLCJ0aHJvdHRsZVRpbWUiLCJfZXJyb3JUaHJvdHRsZVRpbWUiLCJvcHRzIiwidXJsIiwibWV0aG9kIiwicGFyYW1zIiwibGltaXQiLCJoZWFkZXJzIiwiX3Rva2VuIiwianNvbiIsInBhY2tldHMiLCJfZG9tYWluQ2xpZW50IiwicmVxdWVzdENvcHlGYWN0b3J5Iiwib25UcmFuc2FjdGlvbiIsImxlbmd0aCIsIkRhdGUiLCJ0aW1lIiwiZ2V0VGltZSIsImVyciIsIm9uRXJyb3IiLCJuYW1lIiwiX2xvZ2dlciIsImVycm9yIiwiTWF0aCIsImZsb29yIiwiUHJvbWlzZSIsInJlcyIsInNldFRpbWVvdXQiLCJtaW4iLCJjb25zdHJ1Y3RvciIsImRvbWFpbkNsaWVudCIsIkxvZ2dlck1hbmFnZXIiLCJnZXRMb2dnZXIiXSwibWFwcGluZ3MiOiJBQUFBOztDQUVDLEdBQUU7Ozs7Ozs7ZUFTa0JBOzs7c0VBUEs7cUVBQ0Q7K0RBQ0M7Ozs7OztBQUtYLElBQUEsQUFBTUEsNkJBQU4sTUFBTUEsbUNBQW1DQyxzQkFBYTtJQWVuRTs7O0dBR0MsR0FDRCxJQUFJQywrQkFBK0I7UUFDakMsT0FBTyxJQUFJLENBQUNDLDZCQUE2QjtJQUMzQztJQUVBOzs7R0FHQyxHQUNELElBQUlDLGlDQUFpQztRQUNuQyxPQUFPLElBQUksQ0FBQ0MsK0JBQStCO0lBQzdDO0lBRUE7Ozs7OztHQU1DLEdBQ0RDLCtCQUErQkMsUUFBUSxFQUFFQyxVQUFVLEVBQUVDLFNBQVMsRUFBRTtRQUM5RCxNQUFNQyxhQUFhQyxxQkFBWSxDQUFDQyxRQUFRLENBQUM7UUFDekMsSUFB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